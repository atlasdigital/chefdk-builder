name: chefdk-builder
version: 1.1.8
type: main
platform: ubuntu@12.04
description: Wercker box for ChefDK
keywords:
  - chef
  - chef-dk
  - ruby
packages:
  - chef-dk@0.5.1-1
script: |
  sudo apt-get -y update
  sudo apt-get -y install git wget build-essential autoconf
  sudo wget -nv -N -P /var/cache/downloads https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/12.04/x86_64/chefdk_0.5.1-1_amd64.deb
  sudo dpkg -i /var/cache/downloads/chefdk_0.5.1-1_amd64.deb
  sudo rm -f /var/cache/downloads/chefdk_0.5.1-1_amd64.deb
  chef -v
  echo 'eval "$(chef shell-init bash)"' | sudo tee --append /etc/profile > /dev/null
  cat > Gemfile <<_EOF_
    source 'https://rubygems.org'

    ruby '2.1.5'

    gem 'rake', '10.4.2'
    gem 'chef', '12.0.3'
    gem 'berkshelf', '3.2.3'
    gem 'chef-vault', '2.5.0'
    gem 'chefspec', '4.2.0'
    gem 'foodcritic', '4.0.0'
    gem 'test-kitchen'
  _EOF_
  bundle install
